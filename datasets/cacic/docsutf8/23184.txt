AutÃ³matas celulares sobre grafos de nodos irregulares aplicaciÃ³n a la simulaciÃ³n de escurrimientos superficiales en zonas de llanura
ï»¿
El modelo AQUA-GRAPH [4] de escurrimiento superficial especÃ­fico para zonas de llanuras 
se basa en la tecnologÃ­a de autÃ³matas celulares (AC), de amplia utilizaciÃ³n en la simulaciÃ³n 
de procesos naturales. Este modelo se implementa sobre una estructura de datos grafo. 
Este diseÃ±o da una mayor flexibilidad al modelo de escurrimiento y al simulador permitiendo 
realizar diferentes tipos de discretizaciones con el objeto de mejorar la performance y dar 
diferentes niveles de detalle a la simulaciÃ³n. 
En el presente trabajo se perfeccionÃ³ el autÃ³mata AQUA-GRAPH para poder trabajar con 
cÃ©lulas de diferente tamaÃ±o teniendo en cuenta el Ã¡rea y el volumen de agua acumulado en 
cada celda. Sobre este esquema se desarrollÃ³ un algoritmo para discretizar el terreno 
agrupando conjuntos de celdas con similares caracterÃ­sticas en celdas de mayor Ã¡rea. 
Se utilizaron diferentes criterios para fusionar celdas como, diferencia de altura, gradiente 
acumulado y curvatura acumulada. Se evaluaron estas modificaciones sobre escenarios reales 
y analizando la sensibilidad a los diferentes parÃ¡metros. Los resultados permitieron mejorar 
notablemente la performance de las simulaciones al reducir la cantidad de elementos a tratar 
sin perder precisiÃ³n o nivel de detalle en las zonas mÃ¡s importantes. 
Palabras claves: Modelo hidrolÃ³gico distribuido, AutÃ³matas Celulares, Grafos, 
Escurrimiento superficial en llanuras.
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1656
1 INTRODUCCIÃ“N 
En los cincuenta, Ulam y Von Neumann [2] desarrollaron una ingeniosa herramienta 
matemÃ¡tica denominada autÃ³mata celular (AC) que permite simular ciertos fenÃ³menos 
complejos con la integraciÃ³n de cÃ©lulas finitas, que interactÃºan de acuerdo a reglas simples 
basadas en consideraciones heurÃ­sticas. Las reglas de interacciÃ³n que generalmente se aplican 
a los vecinos inmediatos, pueden o no guardar una semejanza con las leyes fÃ­sicas que 
gobiernen el fenÃ³meno. Sin embargo, para fluidos, se encontrÃ³ que los promedios estadÃ­sticos 
tendÃ­an a la soluciÃ³n de las ecuaciones diferenciales parciales que se saben gobiernan la 
situaciÃ³n, tÃ­picamente la ecuaciÃ³n de Navier-Stokes [9].  
Desde entonces, la tecnologÃ­a de AC ha sido utilizada con Ã©xito para la simulaciÃ³n del 
movimiento de fluidos sobre una superficie como el modelo de simulaciÃ³n de escurrimiento 
de lava volcÃ¡nica SCIARA [3] o el modelo de escurrimiento por inventario hidrolÃ³gico 
AQUA [5, 6, 8]. La mayorÃ­a de estas aplicaciones representan el espacio como una grilla 
regular o matriz regular en la que todas las celadas tienen el mismo tamaÃ±o. Este tipo de 
estructuras rÃ­gidas imponen muchas restricciones a los modelos, como la imposibilidad de 
contar con celdas de diferentes formas o tamaÃ±os, con el consecuente uso ineficiente de los 
recursos como memoria y tiempo de CPU.  
El modelo numÃ©rico AQUA-GRAPH, que ya ha sido evaluado favorablemente sobre 
escenarios sintÃ©ticos y reales, utiliza como representaciÃ³n interna un grafo no dirigido, esta 
estructura brinda una mayor flexibilidad y permite utilizar tÃ©cnicas de discretizaciÃ³n para 
mejorar el tiempo de respuesta de las simulaciones o aplicar ecuaciones diferentes a sub- 
regiones.
En este trabajo se modificÃ³ el modelo para poder trabajar con celdas de diferentes tamaÃ±os y 
formas sin aumentar el costo computacional del algoritmo. Con esta idea se pretende 
discretizar espacialmente la grilla generada desde el Modelo Digital de ElevaciÃ³n (MDE).  
BÃ¡sicamente, para la simplificaciÃ³n de mallas, las tÃ©cnicas de inserciÃ³n o borrado de vÃ©rtices 
son las mÃ¡s comunes y los sistemas de informaciÃ³n geogrÃ¡fica (SIG) constituyen el ejemplo 
mÃ¡s usual de su aplicaciÃ³n. Una de las tÃ©cnicas mÃ¡s utilizadas es el empleo de clusters (o 
agrupaciones) de vÃ©rtices segÃºn la proximidad geomÃ©trica [7]. El problema de utilizar 
directamente alguna de estas tÃ©cnicas es que no fueron diseÃ±adas especÃ­ficamente para el 
modelo de simulaciÃ³n de escurrimiento sino para visualizaciÃ³n de superficies como los MDE.  
Para el autÃ³mata AQUA-GRAPH es muy importante con que criterio definir la proximidad 
geomÃ©trica de los nodos que se van a agrupar, ya que se deben preservar las pequeÃ±as 
depresiones que actÃºan como reservorios y que influyen en gran manera en el escurrimiento 
superficial en zonas de llanura. En este trabajo, se analizan varios criterios para definir la 
proximidad geomÃ©trica y realizar agrupaciones de nodos afectando lo mÃ­nimo posible la 
respuesta del simulador. Estos criterios fueron implementados y evaluados con escenarios 
reales.
2 EL AUTÃ“MATA AQUA-GRAPH 
La representaciÃ³n interna del AQUA-GRAPH se construye a partir de la grilla del MDE, que 
consiste en un campo escalar h(x, y), asociado a una grilla bidimensional. El campo h(x, y),
representa la coordenada vertical promedio de cada celda espacial. Siguiendo el paradigma de 
AC, el estado superficial de cada celda estÃ¡ determinado por un escalar w(x, y), que representa 
en este caso el nivel de agua en la celda (x, y).
Con cada celda de la grilla se construye un nodo del grafo donde se almacenan los niveles de 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1657
cota del terreno, niveles de agua y de capacidad de infiltraciÃ³n. Posteriormente se agregan 
arcos bi-direccionales entre nodos vecinos en los sentidos vertical y horizontal (Figura 1), a 
los cuales se asocia un costo correspondiente a la resistencia al escurrimiento. Esta resistencia 
al escurrimiento se calcula como la media de las resistencias superficiales de las celdas que 
une (vegetaciÃ³n, rugosidad, etc.). 
Figura 1: Esquema de construcciÃ³n del grafo a partir de la grilla. 
Para cada nodo del grafo se debe establecer si Ã©ste pertenece al terreno o a los cursos de agua. 
Por Ãºltimo, se recorren todas las celdas del rÃ­o realizando conexiones diagonales entre celdas 
para que no se produzcan cortes en el cauce. (Ver Figura 2). 
Figura 2: IdentificaciÃ³n de nodos y arcos del rÃ­o en el grafo y reconstrucciÃ³n de los cauces. 
Una vez construido el grafo, cada celda se comporta como un recipiente cerrado que se 
comunica con otros cuatro, abriendo y cerrando las conexiones dejando que el agua fluya 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1658
debido a la diferencias de altura. 
2.1 Modelo de escurrimiento superficial 
El algoritmo calcula la transferencia de agua entre celdas unidas en base a la ecuaciÃ³n 
hidrÃ¡ulica estacionaria discretizada en el tiempo. El volumen de agua transferido en un paso 
depende de las diferencia de alturas totales (terreno mÃ¡s agua) y del costo del arco. 
Los pasos del algoritmo de escurrimiento son los siguientes: 
1. Para cada celda se crea una lista con las vecinas capaces de recibir agua, o sea, con 
la altura inferior a la del nodo que se estÃ¡ analizando, llamado â€œentornoâ€ (Figura 3). 
2. Para cada celda y su entorno se calcula cual serÃ­a la altura de agua si todo el lÃ­quido 
escurriera a su mÃ­nima posiciÃ³n, llamada altura de drenado. 
3. Para cada celda se determina la cantidad de agua posible de transferir como la 
diferencia entre la altura del actual del nodo y la altura de drenado (si este valor es 
mayor que el total del agua de la celda obviamente el valor se fija en Ã©ste Ãºltimo). 
4. Se calcula el mÃ¡ximo de agua que le corresponde a cada nodo vecino repartiendo el 
total transferible (calculado en 3) pesando con la raÃ­z cuadrada de la diferencia de 
alturas con la celda madre. 
5. Finalmente a cada celda se le transfiere un porcentaje del mÃ¡ximo transferible dado 
por el costo del arco correspondiente (coeficiente de relajaciÃ³n Ä®).
Debe mencionarse que la actualizaciÃ³n del nivel de agua se realiza simultÃ¡neamente en 
paralelo en todas las celdas. 
Figura 3: AnÃ¡lisis de una celda (centro) y las vecinas con posibilidad de recibir agua. 
Este algoritmo fue modificado para trabajar con celdas de diferentes tamaÃ±os. Los cÃ¡lculos se 
realizan con volumen de agua (altura de agua multiplicada por el tamaÃ±o de la celda) en lugar 
de altura. 
2.2 Fuentes de agua 
Los procesos de precipitaciÃ³n e infiltraciÃ³n se modelan como fuentes/sumideros. La 
precipitaciÃ³n simplemente se agrega a cada celda de acuerdo con un esquema temporal 
predeterminado, que puede representar datos observados o escenarios hipotÃ©ticos. 
El proceso de infiltraciÃ³n es mÃ¡s complicado que el de precipitaciÃ³n, cada tasa depende del 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1659
estado de saturaciÃ³n del suelo, el cual cambia cuando al infiltrar agua. Para simular este 
efecto, es necesario registrar el agua infiltrada en cada celda, I(x, y). El volumen de 
infiltraciÃ³n para el paso de tiempo n se calcula como: 
Â°
Â¯
Â°
Â®
Â­
t

 
 


),(),(),(),(),(
),(),(),(0),(
0),(0
),(
11
1
yxIyxIyxwsiyxIyxI
yxIyxIyxwsiyxw
yxwsi
yxI
onon
onn
EE
E  (1) 
donde Io(x, y), es la infiltraciÃ³n base, y E es un coeficiente que representa la caracterÃ­stica de 
saturaciÃ³n del suelo (0<E<1). Valores pequeÃ±os de E significan que el suelo se saturarÃ¡ mÃ¡s 
rÃ¡pido. La infiltraciÃ³n inicial Ii, viene dada por las condiciones iniciales del suelo y deberÃ­a 
ser ingresada por el analista.  
Los procesos de infiltraciÃ³n y precipitaciÃ³n no necesitan ser modificados para trabajar con 
celdas de diferente tamaÃ±o ya que influyen solamente en la altura de agua 
independientemente del Ã¡rea de la celda. 
2.3 Modelado de rÃ­os y arroyos 
Los rÃ­os y arroyos de agua se simulan en modelo AQUA-GRAPH reduciendo la resistencia al 
flujo a lo largo de los cursos de agua correspondientes. Por consiguiente, el valor de Ä® para 
cada arco del grafo que pertenece al rÃ­o se calcula como una funciÃ³n de la altura de agua 
promedio de los nodos que comunica, lo que representa la influencia del perfil del lecho del 
rÃ­o sobre el flujo. 
Como existen numerosos factores que afectan esta relaciÃ³n (perfil del lecho, caracterÃ­sticas 
del suelo, vegetaciÃ³n acuÃ¡tica, etc.) un modelo integral requerirÃ­a la definiciÃ³n de una funciÃ³n 
para cada celda. Sin embargo, esto es prÃ¡cticamente imposible cuando se modelan grandes 
extensiones de terreno. Como alternativa, se pueden definir familias de funciones-Ä® por 
regiones, cuyos parÃ¡metros pueden ser determinados comparando los cÃ¡lculos numÃ©ricos con 
datos experimentales. 
Una familia de funciones que muestra una buena aproximaciÃ³n a las mediciones de caudal de 
los arroyos del sur de la Provincia de Buenos Aires es la siguiente: 
Â¸
Â¸
Â¸
Â¸
Â¸
Â¸
Â¹
Â·






Â©
Â§
Â»
Â»
Â¼
Âº
Â«
Â«
Â¬
Âª
Â¸
Â¹
Â·
Â©
Â§
 nprio
W
H 01
1D  (2)
donde W es la altura  de agua promedio de las celdas conectadas y Ho, p y n son parÃ¡metros 
constantes.
2.4 Condiciones de contorno 
Se aplican condiciones de borde abierto al contorno externo de la regiÃ³n simulada. Esto se 
implementa agregando un borde auxiliar de celdas, con elevaciÃ³n substancialmente inferior a 
las adyacentes del terreno. El volumen de agua contenido en el borde adicional es eliminado a 
cada paso del algoritmo para evitar acumulaciones a largo plazo. Para lograr un correcto 
balance de masas global, es muy importante que el dominio de simulaciÃ³n sea mÃ¡s grande que 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1660
la cuenca en estudio, para permitir que los lÃ­mites de cuenca se determinen automÃ¡ticamente. 
2.5 Escalas temporales diferentes: 
La estructura de grafo permite simular de manera separada el escurrimiento en el terreno y en 
el rÃ­o utilizando diferentes escalas temporales y estableciendo puntos de sincronizaciÃ³n donde 
los resultados de ambas simulaciones son actualizados entre si. El grafo principal se divide en 
dos sub-grafos con arcos comunes entre sÃ­ y por cada ciclo del grafo del terreno, se realizan 
varios ciclos de simulaciÃ³n en el grafo del rÃ­o.
Dado que la cantidad de celdas de rÃ­o es generalmente menor al 1% del total, al aumentar la 
escala temporal a las celdas del terreno, se logra una aceleraciÃ³n casi lineal del proceso global 
de la simulaciÃ³n. 
En la prÃ¡ctica, se utiliza la misma relaciÃ³n temporal para el grafo del rÃ­o, mientras que se 
reduce la cantidad de pasos en el grafo del terreno en una relaciÃ³n que de ahora en mÃ¡s 
denominaremos aceleraciÃ³n. Para obtener resultados equivalentes, al aplicar una aceleraciÃ³n 
al terreno, se debe aumentar en la misma relaciÃ³n el valor de alfa utilizado. Esto pone un 
lÃ­mite a la aceleraciÃ³n ya que el valor de alfa debe ser menor o igual a uno.  
Para las simulaciones del presente estudio se utilizÃ³ siempre un valor de aceleraciÃ³n de 10. 
3 DISCRETIZACIÃ“N DE LA REPRESENTACION EN NODOS IRREGULARES 
Una de las caracterÃ­sticas mÃ¡s importantes que diferencia al modelo AQUA-GRAPH de los 
clÃ¡sicos autÃ³matas celulares de grilla es que permite representar conjuntos de celdas en un 
solo nodo. Esto se debe a que la representaciÃ³n mediante grafo permite separar las relaciones 
de vecindad de las caracterÃ­sticas morfolÃ³gicas del Ã¡rea representada por un nodo. Esto 
permite dar diferentes niveles de detalle espacial al MDE.  
3.1 AgrupaciÃ³n de nodos: 
Se desarrollÃ³ un algoritmo que busca similitudes entre nodos vecinos para agruparlos 
siguiendo un criterio dado. El algoritmo recorre toda la lista de nodos del grafo buscando unir 
a cada nodo con alguno de sus vecinos. Si encuentra un par que cumple con el criterio los une 
creando un nuevo nodo con las caracterÃ­sticas de los agrupados. Este nuevo nodo conserva los 
vecinos de los dos que agrupa, y si tenÃ­an algÃºn vecino comÃºn el nuevo nodo lo tendrÃ¡ pero 
conectado con la suma de las capacidades de las conexiones. El arco que unÃ­a a los nodos 
originales desaparece. Por Ãºltimo se eliminan los nodos originales y el nuevo se agrega al 
final de la lista, pudiendo volver a ser agrupado con otros vecinos cuando el algoritmo llegue 
a ese punto de la lista. El algoritmo termina cuando se recorriÃ³ toda la lista de nodos.  
Figura 5: Esquema de agrupaciÃ³n de nodos, las conexiones mÃ¡s anchas tienen el doble de capacidad. 
Las caracterÃ­sticas de un nodo nuevo que agrupa a dos existentes se calculan de la siguiente 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1661
manera: 
1. El Ãrea es igual a la suma de las Ã¡reas de los nodos agrupados. 
2. La cota de terreno es igual a la suma de alturas de terreno de cada nodo 
multiplicada por el Ã¡rea, dividido el Ã¡rea del nuevo nodo. 
3. El volumen de agua es igual a la suma de los volÃºmenes. Para el caso de que en el 
estado inicial de la simulaciÃ³n el nivel de agua de alguno de los nodos no sea cero. 
Este tipo de uniÃ³n se realiza solamente con los nodos del terreno que son los que requieren 
menos nivel de detalle. Los nodos de rÃ­o representan menos del 1% del grafo y tienen 
conexiones que recalculan sus costos dinÃ¡micamente. 
3.2 Criterios de AgrupaciÃ³n de nodos: 
Se implementaron varios criterios de agrupaciÃ³n de nodos y se evaluaron los resultados.  
Diferencia de altura:  
Como el modelo de escurrimiento trabaja en base a la cota de altura de las celdas, nodos 
vecinos que tienen la misma altura trabajan como uno solo ya que no hay transferencia entre 
ellos si la altura de agua es la misma. Entonces, siguiendo este criterio, si la diferencia de 
altura entre nodos vecinos es inferior a un coeficiente dado, los nodos se unen. 
Gradiente acumulado:
El gradiente es un vector que caracteriza el comportamiento del campo escalar de alturas h(x,
y) en el entorno de la celda ubicada en la fila y columna x, y que se expresa en la ecuaciÃ³n (3) 
cuyas componentes son las derivadas parciales de la funciÃ³n en ese punto. La ecuaciÃ³n (4) 
expresa un esquema centrado de diferencias finitas donde x'  y y'  representan la distancia 
entre los pares de celdas vecinas a la celda.
 yx G,Gy
h,
x
hgrad(h)  Â¸Â¸Â¹
Â·
Â¨Â©
Â§
w
w
w
w  (3) 
x2
hh
x
h
G x
j1,ij1,iji,
ji, '

 
w
w
 
 (4) 
y2
hh
y
hG 1-ji,1ji,ji,
j,iy '

 
w
w
 
 (5) 
Para cada nodo del grafo se calcula el mÃ³dulo del vector gradiente, esta magnitud nos 
mostrarÃ¡ que tan empinada se encuentra la pendiente. Para este criterio, si la celda se 
encuentra en una zona de poco pendiente se puede agrupar con celdas vecinas. Entonces, cada 
vez que dos nodos se agrupan, se acumulan los mÃ³dulos de sus gradientes en el nuevo nodo. 
El gradiente acumulado en cada nodo no debe superar un valor dado como parÃ¡metro. 
Curvatura acumulada:  
Frecuentemente, se recurre al concepto de curvatura para caracterizar la geometrÃ­a local de 
mallas de superficie [1]. En geometrÃ­a diferencial, la curvatura representa la apariencia local 
de una dada superficie. En este trabajo se aplican criterios isotrÃ³picos que evalÃºan una forma 
de la curvatura media (la curvatura local). Las componentes del tensor curvatura se calculan 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1662
tambiÃ©n en forma centrada como: 
 
 
'
Â»
Â»
Â»
Â¼
Âº
Â«
Â«
Â«
Â¬
Âª
Â¹Â¸
Â·
Â©
Â§ 
Â¸
Â¹
Â·
Â©
Â§ 
 


N
2
G yG yG xG x
G yG yG xG x
1-ji,1ji,1-ji,1ji,
j1,ij1,ij1,ij1,i
j,i
 (6) 
donde se asume que ' ' ' yx .
Dado que en nuestra aplicaciÃ³n interesa conocer solo la magnitud de la curvatura y no sus 
componentes individuales, se utilizÃ³ el siguiente indicador: 
   
Â¹Â¸
Â·
Â©
Â§ 
Â¹Â¸
Â·
Â©
Â§  
N GyGyGxGxGyGyGxGx 1-ji,1ji,1-ji,1ji,j1,ij1,ij1,ij1,ij,i
22222  (7) 
Una vez calculada la curvatura K para cada nodo, se procede de manera similar al modo del 
gradiente acumulado para agrupar nodos.  
Criterio combinado:  
Como el objetivo de este estudio es conseguir representar mÃ¡s eficientemente MDEs de zonas 
de llanura para simular procesos hidrolÃ³gicos con el modelo AQUA-GRAPH, es muy 
importante que en el proceso de discretizaciÃ³n no se pierdan las pequeÃ±as depresiones del 
terreno que actÃºan como reservorios de agua y que influyen de gran manera en el 
escurrimiento superficial. Al observar la imagen del MDE luego de una simulaciÃ³n o una 
imagen satelital notamos que la mayor concentraciÃ³n de depresiones inundadas se encuentra 
en la zona baja de la cuenca, donde la pendiente es menor. Por lo tanto, las pequeÃ±as 
depresiones del terreno (valor de curvatura alta) que estÃ¡n ubicadas en la zona de menor 
pendiente (valor de gradiente bajo cercano a cero) no deberÃ­an agruparse. En cambio, celdas 
vecinas con valor de curvatura baja que estÃ¡n en una zona de pendiente (gradiente alto) 
pueden agruparse con sus vecinas ya que no forman reservorios.  
El criterio combinado se define calculando para cada nodo el coeficiente: 
yx
yxyx G
KC
,
,,
1  (8) 
donde Kx,y es el indicador de curvatura y Gx,y es el mÃ³dulo del gradiente. Cada vez que dos 
nodos se agrupan, se acumulan sus coeficientes C. El C acumulado en cada nodo no debe 
superar un valor dado como parÃ¡metro.
4 EVALUACIÃ“N DE LOS DIFERENTES CRITERIOS 
4.1 Escenario real utilizado 
Para evaluar los diferentes criterios de agrupaciÃ³n de nodos, el modelo AQUA-GRAPH se 
aplicÃ³ sobre el MDE de una cuenca real con datos reales de un evento de tormenta. No se 
utilizaron modelos sintÃ©ticos como planos inclinados ya que se buscaba discretizar terrenos 
irregulares con pequeÃ±as depresiones y evaluar su impacto sobre el modelo de escurrimiento. 
La cuenca utilizada estÃ¡ ubicada en el centro de la provincia de buenos Aires, Argentina. 
Entre los 36Âº 8â€™ y los 37Âº 22â€™ de latitud sur y entre los 58Âº 49â€™ y 60Âº 10â€™ de longitud Oeste. Su 
extensiÃ³n es de aproximadamente 150 Km. en la direcciÃ³n Sudoeste-Noreste y de 40 Km. de 
ancho compuesta por una gran planicie con pequeÃ±as sierras en el lÃ­mite sur, donde nace el rÃ­o 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1663
Azul. La pendiente promedio es del 5% en la zona sur y de menos del 0,2% en la llanura 5.  
Como dato input de la geometrÃ­a de la cuenca se utilizÃ³ un MDE con mediciones de 
interferometrÃ­a radar construidas de imÃ¡genes satelitales correspondientes a la misiÃ³n ERS 
Tandem en 1997. Los detalles del procesamiento involucrado en la construcciÃ³n del MDE se 
describen en [10]. El tamaÃ±o de celda del modelo resultante es de 80 m. En la regiÃ³n baja se 
observan numerosas depresiones, las cuales serÃ¡n responsables mÃ¡s adelante de los 
estancamientos de agua. 
La regiÃ³n modelada en este estudio es la cuenca del arroyo Santa catalina, que es un tributario 
del RÃ­o Azul. La longitud de la cuenca es de 32 Km., y drena 158 km2 de los sectores 
superior y medio de la cuenca del rÃ­o Azul. La pendiente tÃ­pica en la cuenca alta es de entre 1 
y 10 % (afloramientos rocosos), mientras que valores del 0,1 a 1 % caracterizan la zona 
media. 
Para este estudio se utilizÃ³ un evento de inundaciÃ³n ocurrido en Agosto de 2002. Se cuenta 
con los siguientes datos hidrolÃ³gicos del evento: 
x PrecipitaciÃ³n acumulada proveniente de pluviÃ³metros distribuidos a lo largo de la 
cuenca. 
x Hydrograma de la cuenca Santa Catalina calculado de la curva HQ utilizando datos 
de nivel de agua medidos en la salida de la cuenca. 
x Nivel freÃ¡tico previo a la lluvia. 
Los parÃ¡metros de escurrimiento e infiltraciÃ³n utilizados en las simulaciones son los mismos 
que en [4].  
4.2 ComparaciÃ³n.
Se definieron varios indicadores para poder evaluar los diferentes criterios, estos son: 
Porcentaje de nodos: Para evaluar el grado de discretizaciÃ³n alcanzado, se cuenta la cantidad 
de nodos con la que se representa la cuenca luego de la discretizaciÃ³n. Cuanto menor sea el 
porcentaje sobre la cantidad de celdas originales mayor serÃ¡ el nivel de discretizaciÃ³n 
alcanzado.  
Volumen total eliminado: El volumen total de agua eliminado por el rÃ­o al finalizar la 
simulaciÃ³n nos permite medir si se perdieron algunas de las pequeÃ±as depresiones que 
actuaban como reservorio y por lo tanto el agua que debÃ­a ser retenida por la cuenca drenÃ³ 
hacia el rÃ­o. Este volumen se calcula de manera aproximada en base a las mediciones de 
caudal que se tomadas una por hora. 
Hidrogramas de salida: Se analizaron los hidrogramas de salida en comparaciÃ³n con las 
mediciones originales y las simulaciones con el MDE original con el objeto de evaluar la 
precisiÃ³n.
Para cada criterio, se buscÃ³ el mayor porcentaje posible de discretizaciÃ³n con la menor 
diferencia en los hidrogramas de salida y el volumen eliminado. Los resultados se muestran 
en la Tabla 1. 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1664
 Tabla 1: Discretizaciones mÃ¡ximas para los diferentes criterios. 
Las figuras 8, 9, 10 y 11 muestran el hietograma de precipitaciones en barras 
correspondiente a los milÃ­metros de agua promedio por hora. Los puntos sÃ³lidos en los 
grÃ¡ficos representan el flujo de descarga de la cuenca al rÃ­o principal.  
0 20 40 60 80 100
0
10
20
30
40
50
60
0
10
20
30
40
50
60
Lluvia [m
m
/H
s]
C
au
da
l [
m
3 /s
eg
]
Criterio Altura - Agosto 2002 - Santa Catalina
Tiempo [Hs]
 Observado
 AQUA-GRAPH 100%
 AQUA-GRAPH  83%
 AQUA-GRAPH  70%
 AQUA-GRAPH  38%
0 20 40 60 80 100
0
10
20
30
40
50
60
0
10
20
30
40
50
60
Lluvia [m
m
/H
s]
C
au
da
l [
m
3 /s
eg
]
Criterio Gradiente - Agosto 2002 - Santa Catalina
Tiempo [Hs]
 Observado
 AQUA-GRAPH 100%
 AQUA-GRAPH  95%
 AQUA-GRAPH  88%
 AQUA-GRAPH  30%
Figura 8       Figura 9 
0 20 40 60 80 100
0
10
20
30
40
50
60
0
10
20
30
40
50
60
Lluvia [m
m
/H
s]
C
au
da
l [
m
3 /s
eg
]
Criterio Curvatura - Agosto 2002 - Santa Catalina
Tiempo [Hs]
 Observado
 AQUA-GRAPH 100%
 AQUA-GRAPH  85%
 AQUA-GRAPH  70%
 AQUA-GRAPH  25%
   
0 20 40 60 80 100
0
10
20
30
40
50
60
0
10
20
30
40
50
60
Lluvia [m
m
/H
s]
C
au
da
l [
m
3 /s
eg
]
Criterio Combinado - Agosto 2002 - Santa Catalina
Tiempo [Hs]
 Observado
 AQUA-GRAPH 100%
 AQUA-GRAPH  45%
 AQUA-GRAPH  30%
 AQUA-GRAPH  18%
Figura 10      Figura 11 
Figuras 8, 9, 10 y 11: Caudal observado (puntos) y calculado (curva) en la salida de la cuenca del Santa Catalina 
para los criterios de agrupaciÃ³n por diferencia de altura, gradiente acumulado, curvatura acumulada y criterio 
combinado respectivamente. 
Agrupamiento Volumen Eliminado 
Criterio Coeficiente de Agrupamiento 
Cantidad 
Nodos Porcentaje del total m
3
Sin Agrupar - 58.394 100 % 3.089.875 
Diferencia de 
Altura 
0,1 48.700 83 % 3.163.868 
Gradiente 
Acumulado 
0,01 55.337 95 % 3.234.556 
Curvatura 
Acumulado 
0,00015 51.289 87 % 3.195.020 
Combinado 0,03 27.265 45 % 3.122.149 
XIII Congreso Argentino de Ciencias de la ComputaciÃ³n
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
 
Congreso General
_________________________________________________________________________
 
 
1665
Al analizar los resultados vemos que con los primeros tres criterios, la cantidad de nodos 
totales necesarios para no perder precisiÃ³n debe ser mayor al 80%. Por debajo de estos 
niveles, los hidrogramas muestran curvas mÃ¡s altas y anchas lo que se traduce en un mayor 
volumen de agua eliminado por el rÃ­o. Esto se debe principalmente a que las pequeÃ±as 
depresiones desaparecen, sobre todo en las zonas de menor pendiente. En cambio, con el 
criterio de agrupaciÃ³n combinado se logrÃ³ una muy buena simulaciÃ³n con el 45% de los 
nodos y una bastante aproximada con sÃ³lo el 30% de los nodos. Si bien estos valores son 
especÃ­ficos para esta cuenca, permiten ver la mejora con respecto a los otros criterios 
implementados.  
5 CONCLUSIONES 
Se adaptÃ³ el modelo de escurrimiento AQUA-GRAPH para trabajar con celdas de diferentes 
tamaÃ±os utilizando el volumen para calcular las transferencias entre celdas y se implementÃ³ 
un algoritmo que agrupa nodos del grafo con caracterÃ­sticas similares.  
Se analizaron e implementaron diferentes criterios de unificaciÃ³n como diferencia de altura, 
gradiente acumulado y curvatura acumulada y se evaluaron los resultados sobre el MDE de 
una cuenca real con datos de una tormenta real. A partir del comportamiento de los primeros 
criterios, se definiÃ³ uno combinando Gradiente y Curvatura que mostrÃ³ dar muchos mejores 
resultados. Para la cuenca del ejemplo se logrÃ³ reproducir de manera muy precisa el 
hidrograma de salida con menos del 50% de los nodos originales. Y se obtuvo una muy buena 
respuesta aproximada con el 30% de las celdas.  
La discretizaciÃ³n espacial implementada, mejora notablemente la performance ya que permite 
reducir la cantidad de elementos a tratar en cada paso de la simulaciÃ³n sin aumentar el costo 
computacional del algoritmo de escurrimiento. El modelo AQUA-GRAPH con la 
modificaciÃ³n para trabajar con celdas de diferentes tamaÃ±os permitirÃ­a tambiÃ©n construir un 
grafo Ãºnico con varios MDEs de diferentes resoluciones unidos.  
6 AGRADECIMIENTOS 
Este proyecto fue financiado por la ComisiÃ³n de Investigaciones CientÃ­ficas de la Provincia 
de Buenos Aires (CICPBA) y la ComisiÃ³n Nacional de EnergÃ­a AtÃ³mica (CNEA). Las 
imÃ¡genes satelitales fueron cedidas por la ComisiÃ³n Nacional de Actividades Espaciales 
(CONAE). Los autores desean agradecer especialmente el apoyo del Instituto de HidrologÃ­a 
de Llanuras (IHLLA), responsable de los datos mostrados en este artÃ­culo.  
